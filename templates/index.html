<!doctype html>
<script>
    function send_prog(){
        var text = document.getElementsByName('text')[0].value;
        fetch("/dig", {method: "POST", body: JSON.stringify(text)})
        .then(response => response.json())
        .then(data => document.getElementsByName('id')[0].value = data);
    };
    function retrive_result(){
        var id = document.getElementsByName('id')[0].value;
        document.getElementsByName('result')[0].value = "No result yet..."
        
        while(document.getElementsByName('result')[0].value.includes("No result yet...")){
            fetch("/dig/"+id, {method: "GET"})
            .then(response => response.json())
            .then(data => document.getElementsByName('result')[0].value = data);

            var start = (new Date()).getTime();
            while((new Date()).getTime() - start < 5000) {
            continue;
        }
        };

    };
</script>
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
    <div>
        <textarea name="text" cols="40" rows="5"></textarea>
    </div>
    <div>
        <button onclick="send_prog()">Submit trace</button>
    </div>
    <div>
        <textarea name="id" cols="40" rows="5"></textarea>
    </div>
    <div>
        <button onclick="retrive_result()">Get invariant</button>
    </div>
    <div>
        <textarea name="result" cols="40" rows="5"></textarea>
    </div>
</body>
</html>